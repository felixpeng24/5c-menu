---
phase: 03-web-frontend
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - web/src/components/hall-card.tsx
  - web/src/components/meal-tabs.tsx
  - web/src/components/station-list.tsx
  - web/src/components/menu-item.tsx
  - web/src/components/ui/badge.tsx
  - web/src/components/ui/skeleton.tsx
autonomous: true

must_haves:
  truths:
    - "Hall card renders with school color background and open/closed badge"
    - "Meal tabs switch between Breakfast/Lunch/Dinner and load correct menu"
    - "Menu items appear grouped by station with dietary tag indicators"
  artifacts:
    - path: "web/src/components/hall-card.tsx"
      provides: "Dining hall card with color background and open/closed badge"
      exports: ["HallCard"]
    - path: "web/src/components/meal-tabs.tsx"
      provides: "Meal period tab switcher triggering menu fetch"
      exports: ["MealTabs"]
    - path: "web/src/components/station-list.tsx"
      provides: "Station grouping with menu items"
      exports: ["StationList"]
    - path: "web/src/components/menu-item.tsx"
      provides: "Single menu item with dietary icons"
      exports: ["MenuItem"]
    - path: "web/src/components/ui/badge.tsx"
      provides: "Open/Closed badge component"
      exports: ["Badge"]
    - path: "web/src/components/ui/skeleton.tsx"
      provides: "Loading skeleton placeholder"
      exports: ["Skeleton"]
  key_links:
    - from: "web/src/components/hall-card.tsx"
      to: "web/src/components/meal-tabs.tsx"
      via: "renders MealTabs inside card"
      pattern: "MealTabs"
    - from: "web/src/components/meal-tabs.tsx"
      to: "web/src/lib/hooks.ts"
      via: "calls useMenu hook on tab change"
      pattern: "useMenu"
    - from: "web/src/components/meal-tabs.tsx"
      to: "web/src/components/station-list.tsx"
      via: "renders StationList with fetched menu data"
      pattern: "StationList"
    - from: "web/src/components/station-list.tsx"
      to: "web/src/components/menu-item.tsx"
      via: "renders MenuItem for each item in station"
      pattern: "MenuItem"
---

<objective>
Build the core dining hall UI components: hall card with school colors and open/closed badge, meal tabs that fetch menus, station groupings, and menu items with dietary icons.

Purpose: These are the primary UI building blocks that compose the vertical scroll feed. Each hall card contains meal tabs which load station-grouped menu items.
Output: Reusable components ready to be composed in the page.
</objective>

<execution_context>
@/Users/felixpeng/.claude/get-shit-done/workflows/execute-plan.md
@/Users/felixpeng/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-web-frontend/03-RESEARCH.md
@.planning/phases/03-web-frontend/03-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Badge, Skeleton, MenuItem, and StationList components</name>
  <files>
    web/src/components/ui/badge.tsx
    web/src/components/ui/skeleton.tsx
    web/src/components/menu-item.tsx
    web/src/components/station-list.tsx
  </files>
  <action>
    1. Create `web/src/components/ui/badge.tsx` -- reusable badge for open/closed status:
       ```tsx
       interface BadgeProps {
         variant: 'open' | 'closed'
         children: React.ReactNode
       }
       ```
       - `open` variant: green background (`bg-green-500 text-white`), pill shape (`rounded-full px-2 py-0.5 text-xs font-semibold`)
       - `closed` variant: muted gray (`bg-gray-600 text-gray-300`), same shape
       - No 'use client' needed -- pure presentational, no hooks

    2. Create `web/src/components/ui/skeleton.tsx` -- loading placeholder:
       - A simple div with `animate-pulse bg-gray-200 dark:bg-gray-700 rounded-lg`
       - Accept `className` prop for sizing: `<Skeleton className="h-4 w-32" />`
       - No 'use client' needed -- pure presentational

    3. Create `web/src/components/menu-item.tsx` -- single menu item with dietary tags:
       ```tsx
       'use client'
       import type { MenuItemResponse } from '@/lib/types'
       import { DIETARY_ICONS } from '@/lib/constants'
       ```
       - Renders item name as text
       - For each tag in `item.tags`, look up `DIETARY_ICONS[tag]` and render the abbreviation in a small pill/badge next to the name
       - Tags that have no icon mapping are silently ignored
       - Layout: flex row, name on left, tag badges on right
       - Light/dark compatible text: `text-white/80` (since it sits on colored card backgrounds)

    4. Create `web/src/components/station-list.tsx` -- station grouping:
       ```tsx
       'use client'
       import type { StationResponse } from '@/lib/types'
       import { MenuItem } from './menu-item'
       ```
       - Accepts `stations: StationResponse[]` prop
       - For each station: render station name as a bold heading, then map items to `<MenuItem />`
       - Handle empty stations array: render a `text-white/60` message "No menu items available"
       - Station name styling: `text-sm font-semibold text-white/70 uppercase tracking-wide mb-1`
       - Items spaced with `space-y-0.5`
  </action>
  <verify>
    Run `cd web && npx tsc --noEmit` -- no type errors.
    Verify all 4 files exist under web/src/components/.
  </verify>
  <done>
    Badge, Skeleton, MenuItem, and StationList components exist, type-check cleanly, and are ready for composition in HallCard and MealTabs.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create HallCard and MealTabs components</name>
  <files>
    web/src/components/hall-card.tsx
    web/src/components/meal-tabs.tsx
  </files>
  <action>
    1. Create `web/src/components/meal-tabs.tsx`:
       ```tsx
       'use client'
       import { useState } from 'react'
       import { useMenu } from '@/lib/hooks'
       import { HALL_MEALS, DEFAULT_MEAL } from '@/lib/constants'
       import { StationList } from './station-list'
       import { StaleBanner } from './stale-banner'
       import { Skeleton } from './ui/skeleton'
       ```
       Props: `hallId: string`, `date: string`, `defaultMeal?: string`

       Behavior:
       - Determine available meals from `HALL_MEALS[hallId]` (fallback to `['breakfast', 'lunch', 'dinner']`)
       - Initialize selected meal state with `defaultMeal` (if it's in the available meals list) or the first available meal
       - Call `useMenu(hallId, date, selectedMeal)` to fetch menu data
       - Render tab bar: horizontal flex row of meal buttons, capitalize meal name
       - Selected tab: `bg-white/20 text-white font-bold` pill
       - Unselected tab: `text-white/70 hover:text-white` text
       - Below tabs: show loading skeleton while `isLoading`, error message on error, `<StationList>` on success
       - If the menu data has `is_stale === true`, render `<StaleBanner>` above stations
       - NOTE: `StaleBanner` will be created in plan 03-03. For now, import it but if it doesn't exist yet at build time, conditionally import or create a placeholder. ACTUALLY -- since plans 02 and 03 run in parallel (same wave), and StaleBanner is simple: create a minimal inline stale indicator in MealTabs instead of importing StaleBanner. Show `"Data may be outdated"` text below tabs when `is_stale` is true, with an amber text style. The real StaleBanner from plan 03 will replace this in plan 04 (page assembly).

       Revised approach: Do NOT import StaleBanner. Instead, inline a simple stale indicator:
       ```tsx
       {data?.is_stale && data.fetched_at && (
         <p className="text-amber-300 text-xs mb-2">Data may be outdated</p>
       )}
       ```

    2. Create `web/src/components/hall-card.tsx`:
       ```tsx
       'use client'
       import type { HallResponse } from '@/lib/types'
       import { COLLEGE_BG } from '@/lib/constants'
       import { Badge } from './ui/badge'
       import { MealTabs } from './meal-tabs'
       ```
       Props: `hall: HallResponse`, `date: string`, `isOpen: boolean`, `currentMeal?: string`

       Layout:
       - Outer div: school color background via `COLLEGE_BG[hall.college]` lookup (fallback `bg-gray-500`), rounded-2xl, padding, text-white
       - Header row: flex between hall name (text-xl font-bold) and Badge (open/closed)
       - Below header: `<MealTabs hallId={hall.id} date={date} defaultMeal={currentMeal} />`
       - Dark mode: school color backgrounds should look the same in dark mode (they are bold enough). Add slight opacity in dark mode: `dark:bg-opacity-90` or use the bg class directly (test at visual checkpoint).

       IMPORTANT: Do NOT use dynamic Tailwind classes like `bg-[${color}]`. Use the COLLEGE_BG lookup map which maps to `@theme`-defined classes (bg-hmc, bg-cmc, etc.). This is the v4-safe pattern.
  </action>
  <verify>
    Run `cd web && npx tsc --noEmit` -- no type errors.
    Verify `web/src/components/hall-card.tsx` and `web/src/components/meal-tabs.tsx` exist.
    Run `cd web && npm run build` -- build succeeds.
  </verify>
  <done>
    HallCard renders school-colored card with open/closed badge. MealTabs fetches menu data via useMenu hook and displays station-grouped items. Both components type-check and build cleanly.
  </done>
</task>

</tasks>

<verification>
1. `cd web && npx tsc --noEmit` passes (all component types resolve)
2. `cd web && npm run build` succeeds
3. HallCard accepts HallResponse + date + isOpen props and renders colored card
4. MealTabs accepts hallId + date and renders tab buttons + station content
5. StationList renders station names with MenuItem children
6. MenuItem shows dietary tag abbreviations from DIETARY_ICONS constant
7. No dynamic Tailwind class names (all colors via @theme lookup map)
</verification>

<success_criteria>
- 6 component files exist and type-check cleanly
- HallCard uses COLLEGE_BG lookup for school colors (not dynamic classes)
- MealTabs fetches menu data via useMenu hook and renders stations
- MenuItem displays dietary icons from constants map
- Build passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/03-web-frontend/03-02-SUMMARY.md`
</output>
